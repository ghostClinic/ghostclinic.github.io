<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>

	<!-- Basic Page Needs
  ================================================== -->
	<meta charset="utf-8">
	<title></title>
	<meta name="description" content="">
	<meta name="author" content="">

	<!-- Mobile Specific Metas
  ================================================== -->
	<meta name="viewport" content="width=device-width, initial-scale=1" />

	<!-- CSS
  ================================================== -->
	<style>
	body {
		margin: 0;
		padding: 0;
		font-family: sans-serif;
		font-size: 1em;
	}

	/* Clear Fix */
	.group:before,
	.group:after {
    content:"";
    display:table;
	}

	.group:after {
    clear:both;
	}

	.group {
    zoom:1;
	}

	.container {
		display: table;
		margin: 20px auto;
	}

	canvas {
		cursor: crosshair;
	}


	.clear {clear: both;}

	</style>


</head>
<body>
<div class="container">
	<canvas id="canvas" width="600" height="400"></canvas>
</div>

<script>
var canvas = document.getElementById('canvas');
var c = canvas.getContext('2d');
var cW = 600;
var cH = 400;

reDraw();

      function getMousePos(canvas, e) {
        var rect = canvas.getBoundingClientRect();
        return {
          x: e.clientX - rect.left,
          y: e.clientY - rect.top
        };
      }

      function getDistance(x1,y1,x2,y2) {
      	var d = Math.sqrt( (x1-x2)*(x1-x2) + (y1-y2)*(y1-y2) );
      	return d;
      }




function reDraw() {
c.clearRect(0,0,cW,cH);
c.fillStyle = "#ccc";
c.fillRect(0,0,cW,cH);
}

var stretchLine = {
	initX: 0,
	initY: 0
};

function drawCircle(x, y, radius, color) {
	color = color || "#666";

	c.fillStyle = color;
	c.beginPath();	
	c.arc(x,y,radius,0,2*Math.PI, true);
	c.closePath();
	c.fill();
}




function mousePath(e) {
	reDraw();
	c.beginPath();
	var x1 = stretchLine.initX;
	var y1 = stretchLine.initY;

	var x2 = getMousePos(canvas, e).x;
	var y2 = getMousePos(canvas, e).y;
	c.moveTo(x1, y1);
	c.lineTo(x2, y2);
	c.stroke();
	//origin circle
	drawCircle(stretchLine.initX, stretchLine.initY, 5);
	//pointer circle - radius equal to the distance between mouse and origin divided by whatever
	drawCircle(x2, y2, getDistance(x1,y1,x2,y2)/8, "#efefef");
}



canvas.addEventListener("mousedown", function(e) {

	stretchLine.initX = getMousePos(canvas, e).x;
	stretchLine.initY = getMousePos(canvas, e).y;
	drawCircle(stretchLine.initX, stretchLine.initY, 5);
	canvas.addEventListener("mousemove", mousePath);

});




document.onmouseup = function(e) {
	canvas.removeEventListener("mousemove", mousePath);
	reDraw();
};


</script>
</body>
</html>